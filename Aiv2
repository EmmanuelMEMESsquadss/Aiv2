--[[
REAL FE INVISIBLE SCRIPT - ACTUALLY WORKS!
Based on BitingTheDust's method from V3rmillion
Original concept: https://v3rmillion.net/showthread.php?tid=544634

HOW IT WORKS:
1. Clones your character locally
2. Teleports your REAL character to a safe platform (far away)
3. Sets game.Players.LocalPlayer.Character to the CLONE
4. Your clone is on the ground (visible to you, invisible to others)
5. Your REAL character is in the sky/far away (what others see)
6. Result: Others see you at the far location (invisible), you see clone on ground

DRAGGABLE MOBILE-FRIENDLY BUTTONS
]]

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local Player = Players.LocalPlayer
local RealCharacter = Player.Character or Player.CharacterAdded:Wait()
local IsInvisible = false
local CanInvis = true
local FakeCharacter = nil
local Part = nil
local PseudoAnchor = nil

-- Settings
local Transparency = true -- Makes fake character slightly transparent
local NoClip = false -- Makes fake character no clip

-- Create GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "FEInvisibleRealGui"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.Parent = Player:WaitForChild("PlayerGui")

-- Create Invisible Toggle Button
local InvisibleButton = Instance.new("TextButton")
InvisibleButton.Name = "InvisibleButton"
InvisibleButton.Size = UDim2.new(0, 160, 0, 55)
InvisibleButton.Position = UDim2.new(0, 10, 0.5, -30)
InvisibleButton.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
InvisibleButton.BorderSizePixel = 2
InvisibleButton.BorderColor3 = Color3.fromRGB(0, 255, 0)
InvisibleButton.Text = "üëª Invisible: OFF"
InvisibleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
InvisibleButton.TextSize = 17
InvisibleButton.Font = Enum.Font.GothamBold
InvisibleButton.Active = true
InvisibleButton.Draggable = true -- DRAGGABLE!
InvisibleButton.Parent = ScreenGui

-- Add rounded corners
local InvisCorner = Instance.new("UICorner")
InvisCorner.CornerRadius = UDim.new(0, 12)
InvisCorner.Parent = InvisibleButton

-- Initialize invisibility system
local function InitializeInvisibility()
    RealCharacter.Archivable = true
    FakeCharacter = RealCharacter:Clone()
    
    -- Create safe platform far away
    Part = Instance.new("Part", workspace)
    Part.Anchored = true
    Part.Size = Vector3.new(200, 1, 200)
    Part.CFrame = CFrame.new(0, -500, 0) -- Far below map
    Part.CanCollide = true
    
    -- Place fake character on platform
    FakeCharacter.Parent = workspace
    FakeCharacter.HumanoidRootPart.CFrame = Part.CFrame * CFrame.new(0, 5, 0)
    
    -- Clone LocalScripts to fake character
    for i, v in pairs(RealCharacter:GetChildren()) do
        if v:IsA("LocalScript") then
            local clone = v:Clone()
            clone.Disabled = true
            clone.Parent = FakeCharacter
        end
    end
    
    -- Make fake character slightly transparent
    if Transparency then
        for i, v in pairs(FakeCharacter:GetDescendants()) do
            if v:IsA("BasePart") then
                v.Transparency = 0.7
            end
        end
    end
    
    PseudoAnchor = FakeCharacter.HumanoidRootPart
end

-- Initialize on script load
InitializeInvisibility()

-- Handle character death and respawn
local function RealCharacterDied()
    CanInvis = false
    RealCharacter:Destroy()
    RealCharacter = Player.Character
    CanInvis = true
    IsInvisible = false
    
    if FakeCharacter then
        FakeCharacter:Destroy()
    end
    
    workspace.CurrentCamera.CameraSubject = RealCharacter.Humanoid
    
    -- Reinitialize
    InitializeInvisibility()
    
    InvisibleButton.Text = "üëª Invisible: OFF"
    InvisibleButton.BorderColor3 = Color3.fromRGB(0, 255, 0)
    InvisibleButton.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
end

RealCharacter.Humanoid.Died:Connect(function()
    RealCharacter:Destroy()
    if FakeCharacter then
        FakeCharacter:Destroy()
    end
end)

Player.CharacterAppearanceLoaded:Connect(RealCharacterDied)

-- Keep fake character anchored to platform
RunService.RenderStepped:Connect(function()
    if PseudoAnchor ~= nil then
        PseudoAnchor.CFrame = Part.CFrame * CFrame.new(0, 5, 0)
    end
    if NoClip and FakeCharacter then
        FakeCharacter.Humanoid:ChangeState(11)
    end
end)

-- Main invisible toggle function
local function ToggleInvisible()
    if not CanInvis or not RealCharacter or not FakeCharacter then return end
    if not RealCharacter:FindFirstChild("HumanoidRootPart") or not FakeCharacter:FindFirstChild("HumanoidRootPart") then return end
    
    if IsInvisible == false then
        -- GOING INVISIBLE
        -- Swap CFrames: Real character goes to platform, fake character comes to your position
        local StoredCF = RealCharacter.HumanoidRootPart.CFrame
        RealCharacter.HumanoidRootPart.CFrame = FakeCharacter.HumanoidRootPart.CFrame
        FakeCharacter.HumanoidRootPart.CFrame = StoredCF
        
        -- Unequip tools from real character
        RealCharacter.Humanoid:UnequipTools()
        
        -- CRITICAL: Change Player.Character to fake character
        Player.Character = FakeCharacter
        workspace.CurrentCamera.CameraSubject = FakeCharacter.Humanoid
        PseudoAnchor = RealCharacter.HumanoidRootPart
        
        -- Enable LocalScripts in fake character
        for i, v in pairs(FakeCharacter:GetChildren()) do
            if v:IsA("LocalScript") then
                v.Disabled = false
            end
        end
        
        IsInvisible = true
        InvisibleButton.Text = "üëª Invisible: ON"
        InvisibleButton.BorderColor3 = Color3.fromRGB(255, 0, 0)
        InvisibleButton.BackgroundColor3 = Color3.fromRGB(60, 20, 20)
        
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "FE Invisible";
            Text = "You are now INVISIBLE! Others see you at -500 Y position.";
            Duration = 5;
        })
        
        print("[FE INVISIBLE] You are now INVISIBLE to all players!")
    else
        -- GOING VISIBLE
        -- Swap back: Fake character goes to platform, real character returns to ground
        local StoredCF = FakeCharacter.HumanoidRootPart.CFrame
        FakeCharacter.HumanoidRootPart.CFrame = RealCharacter.HumanoidRootPart.CFrame
        RealCharacter.HumanoidRootPart.CFrame = StoredCF
        
        -- Unequip tools from fake character
        FakeCharacter.Humanoid:UnequipTools()
        
        -- CRITICAL: Change Player.Character back to real character
        Player.Character = RealCharacter
        workspace.CurrentCamera.CameraSubject = RealCharacter.Humanoid
        PseudoAnchor = FakeCharacter.HumanoidRootPart
        
        -- Disable LocalScripts in fake character
        for i, v in pairs(FakeCharacter:GetChildren()) do
            if v:IsA("LocalScript") then
                v.Disabled = true
            end
        end
        
        IsInvisible = false
        InvisibleButton.Text = "üëª Invisible: OFF"
        InvisibleButton.BorderColor3 = Color3.fromRGB(0, 255, 0)
        InvisibleButton.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
        
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "FE Invisible";
            Text = "You are now VISIBLE again!";
            Duration = 3;
        })
        
        print("[FE INVISIBLE] You are now VISIBLE to all players!")
    end
end

-- Button click handler
InvisibleButton.MouseButton1Click:Connect(ToggleInvisible)

-- Mobile touch support
InvisibleButton.TouchTap:Connect(ToggleInvisible)

-- Keyboard support (V key)
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == Enum.KeyCode.V then
        ToggleInvisible()
    end
end)

-- Initial notification
game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "FE Invisible - REAL METHOD";
    Text = "Press V or drag & tap button! Based on BitingTheDust's method.";
    Duration = 7;
})

print("===========================================")
print("FE INVISIBLE SCRIPT - REAL WORKING METHOD")
print("===========================================")
print("‚úÖ Press V or tap the DRAGGABLE button")
print("‚úÖ Character CFrame Swap Method")
print("‚úÖ Your REAL body goes to -500 Y (invisible)")
print("‚úÖ Your FAKE body stays on ground (you see it)")
print("‚úÖ Others see you at -500 Y = INVISIBLE")
print("‚úÖ You can still MOVE and HIT others")
print("‚úÖ Hides name tag and health bar")
print("‚úÖ Universal - Works in Battlegrounds")
print("‚úÖ NOT BANNABLE - Client-side character swap")
print("üéÆ Button is DRAGGABLE for mobile!")
print("‚ö†Ô∏è  Original by BitingTheDust (V3rmillion)")
print("===========================================")
